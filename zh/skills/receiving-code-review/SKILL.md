---
name: receiving-code-review
description: Use when receiving code review feedback, before implementing suggestions, especially if feedback seems unclear or technically questionable - requires technical rigor and verification, not performative agreement or blind implementation
---

# 接收代码审查

## 概述

代码审查需要技术评估，而不是情感表演。

**核心原则：** 实现前先验证。假设前先询问。技术正确性优先于社交舒适度。

## 响应模式

```
当接收代码审查反馈时：

1. 阅读：完整阅读反馈不做反应
2. 理解：用自己的话重述要求（或询问）
3. 验证：对照代码库现实检查
4. 评估：对这个代码库技术合理吗？
5. 响应：技术确认或有理由的驳回
6. 实现：一次一项，每项测试
```

## 禁止的响应

**永远不要：**
- "你完全正确！"（明确的 CLAUDE.md 违规）
- "好观点！" / "优秀的反馈！"（表演性）
- "让我现在实现那个"（验证之前）

**应该：**
- 重述技术要求
- 询问澄清问题
- 如果错误则用技术理由驳回
- 直接开始工作（行动 > 言语）

## 处理不清晰的反馈

```
如果任何项目不清晰：
  停止 - 还不要实现任何东西
  询问不清晰项目的澄清

为什么：项目可能相关。部分理解 = 错误实现。
```

**示例：**
```
你的合作伙伴："修复 1-6"
你理解 1、2、3、6。对 4、5 不清楚。

❌ 错误：现在实现 1、2、3、6，稍后问 4、5
✅ 正确："我理解项目 1、2、3、6。在继续之前需要澄清 4 和 5。"
```

## 按来源处理

### 来自你的合作伙伴
- **可信** - 理解后实现
- **如果范围不清楚仍然要问**
- **没有表演性同意**
- **跳到行动** 或技术确认

### 来自外部审查者
```
实现之前：
  1. 检查：对这个代码库技术正确吗？
  2. 检查：破坏现有功能吗？
  3. 检查：当前实现有原因吗？
  4. 检查：在所有平台/版本上工作吗？
  5. 检查：审查者理解完整背景吗？

如果建议看起来错误：
  用技术理由驳回

如果无法轻易验证：
  说出来："我无法在没有 [X] 的情况下验证这个。我应该 [调查/询问/继续]？"

如果与你合作伙伴之前的决定冲突：
  先停下来与你的合作伙伴讨论
```

**你的合作伙伴的规则：** "外部反馈 - 要怀疑，但要仔细检查"

## YAGNI 检查针对"专业"功能

```
如果审查者建议"正确实现"：
  grep 代码库查找实际使用

  如果未使用："这个端点没有被调用。删除它（YAGNI）？"
  如果使用：然后正确实现
```

**你的合作伙伴的规则：** "你和审查者都向我汇报。如果我们不需要这个功能，就不要添加它。"

## 实现顺序

```
对于多项反馈：
  1. 首先澄清任何不清楚的内容
  2. 然后按此顺序实现：
     - 阻塞问题（破坏、安全）
     - 简单修复（拼写错误、导入）
     - 复杂修复（重构、逻辑）
  3. 单独测试每个修复
  4. 验证没有回归
```

## 何时驳回

驳回当：
- 建议破坏现有功能
- 审查者缺乏完整背景
- 违反 YAGNI（未使用的功能）
- 对这个技术栈技术不正确
- 存在遗留/兼容性原因
- 与你合作伙伴的架构决策冲突

**如何驳回：**
- 使用技术理由，不是防御性
- 询问具体问题
- 引用工作的测试/代码
- 如果是架构问题则让你的合作伙伴参与

**如果对大声驳回感到不舒服的信号：** "Circle K 发生了奇怪的事情"

## 确认正确的反馈

当反馈确实正确时：
```
✅ "已修复。[简要描述更改了什么]"
✅ "好发现 - [具体问题]。已在 [位置] 修复。"
✅ [直接修复并在代码中展示]

❌ "你完全正确！"
❌ "好观点！"
❌ "谢谢你发现那个！"
❌ "谢谢[任何事]"
❌ 任何感谢表达
```

**为什么没有感谢：** 行动说话。直接修复。代码本身表明你听到了反馈。

**如果你发现自己在写"谢谢"：** 删除它。改为陈述修复。

## 优雅地纠正你的驳回

如果你驳回但错了：
```
✅ "你是对的 - 我检查了 [X] 它确实 [Y]。现在实现。"
✅ "验证了这个你是对的。我最初的理解是错的因为 [原因]。修复中。"

❌ 长篇道歉
❌ 为你的驳回辩护
❌ 过度解释
```

实事求是地陈述纠正并继续。

## 常见错误

| 错误 | 修复 |
|------|------|
| 表演性同意 | 陈述要求或直接行动 |
| 盲目实现 | 先对照代码库验证 |
| 不测试就批量处理 | 一次一个，每个测试 |
| 假设审查者正确 | 检查是否破坏事物 |
| 避免驳回 | 技术正确性 > 舒适度 |
| 部分实现 | 先澄清所有项目 |
| 无法验证，但继续 | 陈述限制，询问方向 |

## 真实示例

**表演性同意（坏）：**
```
审查者："删除遗留代码"
❌ "你完全正确！让我删除那个..."
```

**技术验证（好）：**
```
审查者："删除遗留代码"
✅ "检查中...构建目标是 10.15+，这个 API 需要 13+。需要遗留代码用于向后兼容。当前实现有错误的 bundle ID - 修复它还是放弃 13 前支持？"
```

**YAGNI（好）：**
```
审查者："实现正确的指标跟踪，包括数据库、日期过滤器、CSV 导出"
✅ "已 grep 代码库 - 没有任何东西调用这个端点。删除它（YAGNI）？还是我遗漏了什么使用？"
```

**不清楚的项目（好）：**
```
你的合作伙伴："修复项目 1-6"
你理解 1、2、3、6。对 4、5 不清楚。
✅ "理解 1、2、3、6。在实现之前需要澄清 4 和 5。"
```

## GitHub 线程回复

当回复 GitHub 上的内联审查评论时，在评论线程中回复（`gh api repos/{owner}/{repo}/pulls/{pr}/comments/{id}/replies`），而不是作为顶级 PR 评论。

## 底线

**外部反馈 = 要评估的建议，不是要遵循的命令。**

验证。质疑。然后实现。

没有表演性同意。始终技术严谨。
